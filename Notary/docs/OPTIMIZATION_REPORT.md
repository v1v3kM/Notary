Optimization report — Notary project (summary)

Goal: reduce repo size, remove duplication, improve setup reliability, and highlight missing features.

Findings (summary)
- Large/duplicate assets
  - `Vy 0.4.0.dmg` (~macOS app) and `Notary Doc.pdf` are stored in repo. These increase repo size and are generally unnecessary in source control.
- Duplicate SQL and setup scripts
  - Multiple SQL files: `database-schema.sql`, `database_setup.sql`, `IMMEDIATE_FIX.sql`, `insert-sample-data.sql`, `COMPLETE_*` files generated by scripts. Hard to know which to run.
  - Multiple setup scripts: `auto-setup.js`, `auto-setup-db.js`, `one-click-setup.js`, `final-setup.js`, `ultimate-setup.js`, `interactive-setup.js`, `setup-supabase.js`, `fix-login-error.js`, `simple-setup.js` — many variants that duplicate logic.
- Security / secrets risk
  - Many docs show example keys; `.env.local` must not be committed. Added `.gitignore` to help.
- SQL inconsistencies
  Mixed UUID usage has been consolidated to `gen_random_uuid()` with `pgcrypto` in the canonical schema. Remaining setup scripts were updated to match; any leftover generated SQL should be re-generated from the canonical file.
  - Direct `INSERT INTO storage.buckets` used in SQL — not portable on hosted Supabase.
- Runtime fragility
  - Scripts abort when `SUPABASE_SERVICE_ROLE_KEY` is placeholder; adjusted `auto-setup.js` to be more tolerant.
  - Reliance on `exec_sql` RPC may not work without server-side function or special privileges.
- Missing or unclear files
  - README references `appointment-schema.sql` which doesn't exist; updated to use canonical `database-schema.sql`.

Prioritized recommendations (quick wins)
1. Remove large binary assets from the repo (move to release assets or external storage). Files: `Vy 0.4.0.dmg`, `Notary Doc.pdf`.
2. Consolidate SQL: pick `database-schema.sql` as canonical. Move sample data to `seeds/` and remove duplicate or auto-generated SQL files from repo (keep generated output excluded via `.gitignore`).
3. Standardize UUID usage: repo has been updated to prefer `gen_random_uuid()` with `pgcrypto`. Update: `database-schema.sql` now uses `pgcrypto` and `gen_random_uuid()` as the canonical approach. Other SQL files should be aligned to this.
4. Replace `INSERT INTO storage.buckets` SQL with explicit CLI or dashboard instruction. Update setup scripts to use `supabase storage bucket create documents --public` where possible.
5. Replace `exec_sql` RPC usage with either `supabase db push` (CLI) or manual SQL run instructions. Document which approach is supported.
6. Keep a single setup script (e.g. `setup-supabase.js`) that is maintained; remove or archive others, or make them wrappers calling the canonical script.
7. Implement a `scripts/seed.js` that uses Supabase service key to create demo auth users + profiles so `insert-sample-data.sql` aligns with `auth.users`.
8. Add unit smoke tests for SQL parsing and a CI job to validate the SQL runs (best-effort) or at least linting for JS and TypeScript.

Missing features listed
- Payment gateway server endpoints and webhook verification (Razorpay integrated in DB but server handling incomplete)
- Verified email / SMTP integration and configuration with robust fallbacks
- Explicit appointment-specific SQL if appointment tables are split — reconfirm whether `database-schema.sql` contains all appointment tables (it does in current repo)
- Clear, unified setup path for contributors (added `QUICKSTART.md`) and removal of redundant scripts
- Placeholder images endpoint or static placeholder assets for profile photos

Estimated effort (low / medium / high)
- Low: Add `.gitignore`, `QUICKSTART.md`, small README fixes, remove large binaries (or move to releases)
- Medium: Consolidate SQL, standardize UUID functions, update setup scripts to use CLI instead of RPC
- High: Implement seeding script that creates auth users + profiles, implement payment webhooks and email service integration

If you want, I can proceed to:
- A. Remove large files from repo history (interactive — requires git filter-branch or `git filter-repo`; I can produce instructions but will not run destructive history rewrite without confirmation).
- B. Consolidate SQL files: choose canonical file and rewrite others to reference it; standardize UUID function.
- C. Create a single canonical setup script (`scripts/setup.js`) that uses the Supabase CLI when available and falls back to generating SQL.

Which of A/B/C should I implement next? Also, confirm if I should delete or move large binary files now or just mark them for removal (I will not rewrite git history without your confirmation).
